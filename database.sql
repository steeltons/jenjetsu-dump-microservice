CREATE TABLE tariff(
   id VARCHAR(2) PRIMARY KEY,
   basic_price NUMERIC(6,2) NOT NULL CHECK (basic_price BETWEEN 0 AND 100000),
   input_cost NUMERIC(6,2) NOT NULL CHECK (input_cost BETWEEN 0 AND 99),
   output_cost NUMERIC(6,2) NOT NULL CHECK (input_cost BETWEEN 0 AND 99),
   monetary_unit VARCHAR(12) NOT NULL
);
CREATE TABLE tariff_option(
  option_id BIGSERIAL PRIMARY KEY,
  incoming_buffer_cost NUMERIC(6, 2) NOT NULL,
  outcoming_buffer_cost NUMERIC(6,2) NOT NULL,
  tariff_duration_minutes INTEGER NOT NULL,
  free_between_providers BOOLEAN DEFAULT FALSE,
  tariff_id VARCHAR(2),
  FOREIGN KEY(tariff_id) REFERENCES tariff(id)
)

CREATE TABLE refresh_token(
  id VARCHAR(36) PRIMARY KEY,
  owner_id VARCHAR(11) NOT NULL
);
CREATE TABLE abonent_payload(
    payload_id BIGSERIAL PRIMARY KEY,
    call_type INT2 NOT NULL,
    start_time TIMESTAMP NOT NULL,
    end_time TIMESTAMP NOT NULL,
    duration TIME NOT NULL CHECK(duration > '00:00:00'::TIME),
    COST NUMERIC(6,2) NOT NULL CHECK(COST >= 0.0),
    abonent_id BIGSERIAL,
    FOREIGN KEY(abonent_id) REFERENCES abonent(id),
    CHECK(end_time > start_time)
);
CREATE TABLE abonent(
    id BIGSERIAL PRIMARY KEY,
    phone_number BIGSERIAL NOT NULL UNIQUE CHECK(phone_number BETWEEN 10000000000 AND 99999999999),
    balance NUMERIC(6,2) NOT NULL CHECK(balance BETWEEN 0.0 AND 1000000.0),
    tariff_id VARCHAR(2) NOT NULL,
    FOREIGN KEY (tariff_id) REFERENCES tariff(id)
);

INSERT INTO public.abonent (id,phone_number,balance,tariff_id) VALUES
   (550,79146878357,902.41,'06'),
   (552,79146878354,887.32,'06'),
   (553,79146878353,166.44,'06'),
   (559,79146878339,635.57,'06'),
   (564,79146878348,353.79,'06'),
   (574,79146878393,322.52,'06'),
   (577,79146878374,500.34,'06'),
   (580,79146878369,679.50,'06'),
   (581,79146878368,435.81,'06'),
   (588,79146878418,671.87,'06');
INSERT INTO public.abonent (id,phone_number,balance,tariff_id) VALUES
  (589,79146878431,316.15,'06'),
  (596,79146878410,468.25,'06'),
  (597,79146878409,809.86,'06'),
  (598,79146878408,143.87,'06'),
  (600,79146878451,700.53,'06'),
  (602,79146878449,545.53,'06'),
  (608,79146878438,616.42,'06'),
  (616,79146878441,702.44,'06'),
  (619,79146878229,8.56,'06'),
  (622,79146878225,647.83,'06');
INSERT INTO public.abonent (id,phone_number,balance,tariff_id) VALUES
  (623,79146878224,663.84,'06'),
  (632,79146878223,932.41,'06'),
  (633,79146878222,308.70,'06'),
  (634,79146878218,488.16,'06'),
  (635,79146878217,608.07,'06'),
  (644,79146878266,720.21,'06'),
  (645,79146878265,228.43,'06'),
  (647,79146878255,346.25,'06'),
  (655,79146878288,367.64,'06'),
  (658,79146878300,975.63,'06');
INSERT INTO public.abonent (id,phone_number,balance,tariff_id) VALUES
  (659,79146878299,801.09,'06'),
  (662,79146878275,512.02,'06'),
  (666,79146878286,374.03,'06'),
  (667,79146878285,372.88,'06'),
  (670,79146878325,238.04,'06'),
  (672,79146878335,206.09,'06'),
  (673,79146878334,654.20,'06'),
  (675,79146878331,675.85,'06'),
  (680,79146878318,234.53,'06'),
  (681,79146878314,151.85,'06');
INSERT INTO public.abonent (id,phone_number,balance,tariff_id) VALUES
  (653,79146878291,795.07,'11'),
  (656,79146878302,350.02,'11'),
  (664,79146878272,831.14,'11'),
  (555,79146878366,159.28,'11'),
  (674,79146878333,38.63,'11'),
  (558,79146878340,230.57,'03'),
  (561,79146878337,812.63,'11'),
  (676,79146878307,74.81,'11'),
  (585,79146878377,25.83,'11'),
  (579,79146878372,964.06,'11');
INSERT INTO public.abonent (id,phone_number,balance,tariff_id) VALUES
  (601,79146878450,72.62,'11'),
  (615,79146878443,134.16,'11'),
  (612,79146878447,220.13,'03'),
  (613,79146878446,130.72,'11'),
  (614,79146878445,52.79,'11'),
  (617,79146878440,500.46,'03'),
  (627,79146878236,623.60,'11'),
  (629,79146878234,432.40,'11'),
  (630,79146878212,286.28,'11'),
  (646,79146878240,940.15,'11');
INSERT INTO public.abonent (id,phone_number,balance,tariff_id) VALUES
  (649,79146878251,82.14,'03'),
  (665,79146878287,305.77,'11'),
  (668,79146878284,413.80,'11'),
  (556,79146878360,913.90,'11'),
  (567,79146878345,250.64,'11'),
  (570,79146878385,5.80,'03'),
  (582,79146878383,576.34,'11'),
  (571,79146878399,120.52,'11'),
  (587,79146878419,355.41,'11'),
  (610,79146878433,931.29,'11');
INSERT INTO public.abonent (id,phone_number,balance,tariff_id) VALUES
  (575,79146878392,123.43,'03'),
  (603,79146878463,541.11,'11'),
  (621,79146878227,75.64,'11'),
  (625,79146878238,579.69,'11'),
  (628,79146878235,478.45,'03'),
  (638,79146878262,313.20,'11'),
  (639,79146878260,719.52,'11'),
  (642,79146878256,234.78,'11'),
  (652,79146878292,110.77,'03'),
  (636,79146878216,810.04,'11');
INSERT INTO public.abonent (id,phone_number,balance,tariff_id) VALUES
  (687,79146878108,587.67,'06'),
  (688,79146878106,497.82,'06'),
  (693,79146878091,591.35,'06'),
  (694,79146878090,303.03,'06'),
  (697,79146878131,361.07,'06'),
  (698,79146878130,581.95,'06'),
  (701,79146878141,970.81,'06'),
  (705,79146878119,632.52,'06'),
  (706,79146878113,186.29,'06'),
  (707,79146878127,622.29,'06');
INSERT INTO public.abonent (id,phone_number,balance,tariff_id) VALUES
  (708,79146878125,324.79,'06'),
  (712,79146878167,507.01,'06'),
  (715,79146878161,574.90,'06'),
  (717,79146878175,325.53,'06'),
  (724,79146878145,655.34,'06'),
  (727,79146878152,342.28,'06'),
  (732,79146878204,114.95,'06'),
  (736,79146878178,362.98,'06'),
  (746,79146878992,632.04,'06'),
  (750,79146878976,467.27,'06');
INSERT INTO public.abonent (id,phone_number,balance,tariff_id) VALUES
  (751,79146878990,535.00,'06'),
  (752,79146878989,552.76,'06'),
  (754,79146878987,510.60,'06'),
  (757,79146878006,616.96,'06'),
  (761,79146878000,736.49,'06'),
  (764,79146878008,111.98,'06'),
  (771,79146878044,984.58,'06'),
  (773,79146878040,829.36,'06'),
  (774,79146878020,632.44,'06'),
  (775,79146878017,56.13,'06');
INSERT INTO public.abonent (id,phone_number,balance,tariff_id) VALUES
  (777,79146878031,16.50,'06'),
  (781,79146878026,746.00,'06'),
  (783,79146878071,330.65,'06'),
  (784,79146878070,899.67,'06'),
  (786,79146878068,475.05,'06'),
  (787,79146878067,398.05,'06'),
  (794,79146878072,410.80,'06'),
  (799,79146878061,426.74,'06'),
  (802,79146878057,102.12,'06'),
  (803,79146878056,590.14,'06');
INSERT INTO public.abonent (id,phone_number,balance,tariff_id) VALUES
  (804,79146878870,117.39,'06'),
  (807,79146878878,235.49,'06'),
  (808,79146878875,312.27,'06'),
  (810,79146878873,937.69,'06'),
  (811,79146878853,282.90,'06'),
  (813,79146878849,495.87,'06'),
  (814,79146878861,673.24,'06'),
  (801,79146878058,395.20,'11'),
  (726,79146878156,751.95,'11'),
  (718,79146878171,277.55,'03');
INSERT INTO public.abonent (id,phone_number,balance,tariff_id) VALUES
  (728,79146878198,224.68,'11'),
  (719,79146878169,806.31,'11'),
  (725,79146878157,190.85,'03'),
  (729,79146878193,89.81,'11'),
  (731,79146878205,117.15,'11'),
  (760,79146878001,570.69,'11'),
  (733,79146878182,328.19,'11'),
  (734,79146878181,97.95,'03'),
  (695,79146878135,429.10,'11'),
  (747,79146878983,229.77,'11');
INSERT INTO public.abonent (id,phone_number,balance,tariff_id) VALUES
  (683,79146878103,26.45,'03'),
  (737,79146878177,905.13,'11'),
  (741,79146878185,817.61,'11'),
  (689,79146878085,476.51,'11'),
  (763,79146878011,316.19,'11'),
  (765,79146878039,196.64,'11'),
  (742,79146878998,323.73,'11'),
  (785,79146878069,687.47,'11'),
  (793,79146878074,371.09,'03'),
  (744,79146878996,681.34,'11');
INSERT INTO public.abonent (id,phone_number,balance,tariff_id) VALUES
  (710,79146878121,839.22,'11'),
  (805,79146878866,885.99,'11'),
  (756,79146878985,828.67,'11'),
  (759,79146878002,217.36,'11'),
  (809,79146878874,418.92,'11'),
  (767,79146878035,901.59,'11'),
  (686,79146878110,379.02,'11'),
  (769,79146878033,655.79,'11'),
  (815,79146878856,390.66,'11'),
  (772,79146878043,170.37,'11');
INSERT INTO public.abonent (id,phone_number,balance,tariff_id) VALUES
  (782,79146878025,397.76,'11'),
  (696,79146878133,798.67,'11'),
  (817,79146878898,64.30,'03'),
  (789,79146878065,287.51,'03'),
  (796,79146878049,363.01,'11'),
  (704,79146878136,299.96,'11'),
  (709,79146878122,73.81,'11'),
  (816,79146878901,262.97,'11'),
  (797,79146878048,706.15,'11'),
  (800,79146878060,53.51,'03');
INSERT INTO public.abonent (id,phone_number,balance,tariff_id) VALUES
  (770,79146878032,379.35,'03'),
  (779,79146878028,504.35,'03'),
  (738,79146878176,951.87,'11'),
  (699,79146878143,835.65,'11'),
  (723,79146878147,432.35,'11'),
  (711,79146878120,24.88,'11'),
  (822,79146878909,739.77,'06'),
  (824,79146878906,835.42,'06'),
  (825,79146878904,444.44,'06'),
  (829,79146878891,231.57,'06');
INSERT INTO public.abonent (id,phone_number,balance,tariff_id) VALUES
  (834,79146878943,87.07,'06'),
  (837,79146878937,697.38,'06'),
  (838,79146878915,149.86,'06'),
  (839,79146878927,739.27,'06'),
  (841,79146878922,750.50,'06'),
  (845,79146878961,119.89,'06'),
  (851,79146878969,830.52,'06'),
  (854,79146878949,959.20,'06'),
  (855,79146878948,999.96,'06'),
  (862,79146878954,694.34,'06');
INSERT INTO public.abonent (id,phone_number,balance,tariff_id) VALUES
  (866,79146878736,399.95,'06'),
  (875,79146878723,81.65,'06'),
  (881,79146878775,34.06,'06'),
  (887,79146878779,192.22,'06'),
  (892,79146878756,445.48,'06'),
  (894,79146878753,243.24,'06'),
  (896,79146878764,1.93,'06'),
  (899,79146878761,683.67,'06'),
  (900,79146878806,312.75,'06'),
  (902,79146878804,365.70,'06');
INSERT INTO public.abonent (id,phone_number,balance,tariff_id) VALUES
  (903,79146878803,342.63,'06'),
  (906,79146878812,321.37,'06'),
  (907,79146878810,448.04,'06'),
  (909,79146878790,213.24,'06'),
  (910,79146878788,508.71,'06'),
  (912,79146878786,167.28,'06'),
  (916,79146878797,393.24,'06'),
  (918,79146878795,112.82,'06'),
  (919,79146878794,140.72,'06'),
  (922,79146878838,83.02,'06');
INSERT INTO public.abonent (id,phone_number,balance,tariff_id) VALUES
  (923,79146878835,795.53,'06'),
  (925,79146878833,833.85,'06'),
  (926,79146878832,229.96,'06'),
  (927,79146878845,932.50,'06'),
  (928,79146878842,366.75,'06'),
  (932,79146878819,202.91,'06'),
  (934,79146878826,570.59,'06'),
  (940,79146878609,839.01,'06'),
  (941,79146878622,163.69,'06'),
  (942,79146878616,807.10,'06');
INSERT INTO public.abonent (id,phone_number,balance,tariff_id) VALUES
  (950,79146878647,966.85,'06'),
  (951,79146878645,593.73,'06'),
  (953,79146878643,209.13,'06'),
  (873,79146878725,525.39,'11'),
  (924,79146878834,18.85,'11'),
  (874,79146878724,354.99,'11'),
  (883,79146878772,650.29,'11'),
  (897,79146878763,748.73,'11'),
  (828,79146878893,263.52,'11'),
  (901,79146878805,335.92,'11');
INSERT INTO public.abonent (id,phone_number,balance,tariff_id) VALUES
  (943,79146878597,282.70,'03'),
  (931,79146878821,827.83,'11'),
  (904,79146878802,925.22,'11'),
  (830,79146878889,198.61,'03'),
  (831,79146878888,469.09,'11'),
  (833,79146878930,853.22,'11'),
  (890,79146878776,438.85,'11'),
  (933,79146878818,345.52,'11'),
  (936,79146878615,790.70,'11'),
  (937,79146878614,65.80,'11');
INSERT INTO public.abonent (id,phone_number,balance,tariff_id) VALUES
  (908,79146878791,414.51,'11'),
  (846,79146878960,141.63,'11'),
  (944,79146878596,9.35,'11'),
  (859,79146878958,288.23,'03'),
  (911,79146878787,718.69,'11'),
  (895,79146878767,612.06,'11'),
  (946,79146878603,781.55,'11'),
  (850,79146878971,209.88,'11'),
  (913,79146878784,149.36,'11'),
  (885,79146878768,509.54,'11');
INSERT INTO public.abonent (id,phone_number,balance,tariff_id) VALUES
  (819,79146878896,77.94,'11'),
  (821,79146878910,636.86,'11'),
  (914,79146878799,569.10,'11'),
  (921,79146878792,3.30,'03'),
  (930,79146878822,587.13,'11'),
  (935,79146878825,210.95,'11'),
  (877,79146878733,899.48,'11'),
  (823,79146878907,543.94,'11'),
  (843,79146878965,249.64,'11'),
  (853,79146878950,185.45,'03');
INSERT INTO public.abonent (id,phone_number,balance,tariff_id) VALUES
  (884,79146878771,180.02,'03'),
  (820,79146878911,926.16,'11'),
  (888,79146878778,527.55,'11'),
  (948,79146878601,924.46,'11'),
  (889,79146878777,447.46,'11'),
  (849,79146878972,12.07,'11'),
  (893,79146878755,625.17,'11'),
  (856,79146878947,150.11,'03'),
  (818,79146878897,927.24,'11'),
  (860,79146878957,421.81,'11');
INSERT INTO public.abonent (id,phone_number,balance,tariff_id) VALUES
  (865,79146878741,59.91,'03'),
  (871,79146878727,157.72,'03'),
  (867,79146878751,274.42,'03'),
  (869,79146878746,614.21,'11'),
  (954,79146878640,404.98,'06'),
  (957,79146878630,729.78,'06'),
  (964,79146878632,170.68,'06'),
  (967,79146878673,910.49,'06'),
  (968,79146878672,469.59,'06'),
  (974,79146878667,662.28,'06');
INSERT INTO public.abonent (id,phone_number,balance,tariff_id) VALUES
  (976,79146878708,586.90,'06'),
  (979,79146878716,617.83,'06'),
  (981,79146878713,283.24,'06'),
  (987,79146878700,199.48,'06'),
  (990,79146878486,252.91,'06'),
  (993,79146878494,111.26,'06'),
  (997,79146878467,438.72,'06'),
  (998,79146878465,632.30,'06'),
  (999,79146878464,187.76,'06'),
  (1006,79146878516,208.38,'06');
INSERT INTO public.abonent (id,phone_number,balance,tariff_id) VALUES
  (1009,79146878525,55.40,'06'),
  (1010,79146878522,440.71,'06'),
  (1013,79146878501,731.34,'06'),
  (1016,79146878509,346.50,'06'),
  (1022,79146878547,105.77,'06'),
  (1030,79146878529,776.57,'06'),
  (1031,79146878528,221.94,'06'),
  (1034,79146878583,344.05,'06'),
  (1038,79146878576,484.13,'06'),
  (1042,79146878566,150.77,'06');
INSERT INTO public.abonent (id,phone_number,balance,tariff_id) VALUES
  (1044,79146878562,716.97,'06'),
  (1046,79146878574,723.85,'06'),
  (1011,79146878520,725.20,'11'),
  (1012,79146878503,363.42,'03'),
  (1025,79146878555,61.57,'03'),
  (984,79146878693,428.88,'11'),
  (1027,79146878534,206.83,'11'),
  (1040,79146878587,859.32,'11'),
  (1041,79146878585,41.47,'03'),
  (1002,79146878475,8.53,'11');
INSERT INTO public.abonent (id,phone_number,balance,tariff_id) VALUES
  (1003,79146878474,915.83,'11'),
  (1052,89146758167,0.00,'03'),
  (1021,79146878551,473.35,'11'),
  (1026,79146878554,592.55,'11'),
  (1050,79146878569,802.11,'11'),
  (958,79146878629,694.26,'11'),
  (1001,79146878476,302.82,'11'),
  (971,79146878661,209.10,'11'),
  (977,79146878706,585.82,'11'),
  (986,79146878703,313.80,'11');
INSERT INTO public.abonent (id,phone_number,balance,tariff_id) VALUES
  (989,79146878696,365.70,'11'),
  (991,79146878484,334.14,'03'),
  (992,79146878483,772.92,'11'),
  (1005,79146878517,337.16,'11'),
  (978,79146878719,214.62,'11'),
  (1017,79146878508,298.07,'03'),
  (1018,79146878507,533.85,'11'),
  (1035,79146878581,717.01,'11'),
  (1023,79146878546,525.36,'11'),
  (1036,79146878579,132.76,'11');
INSERT INTO public.abonent (id,phone_number,balance,tariff_id) VALUES
  (1024,79146878545,438.76,'11'),
  (1045,79146878560,508.10,'11'),
  (1051,89146878167,1048.50,'06'),
  (960,79146878638,661.55,'11'),
  (961,79146878636,221.55,'03'),
  (966,79146878675,592.18,'11'),
  (980,79146878714,905.50,'11'),
  (982,79146878695,64.19,'11'),
  (983,79146878694,917.79,'11'),
  (988,79146878699,243.17,'11');
INSERT INTO public.abonent (id,phone_number,balance,tariff_id) VALUES
  (1000,79146878479,37.87,'03'),
  (965,79146878677,287.02,'11'),
  (1004,79146878472,704.98,'11'),
  (1008,79146878514,443.87,'11');

INSERT INTO public.tariff (id,basic_price,input_cost,output_cost,monetary_unit,option_id) VALUES
  ('03',0.00,1.50,1.50,'rubbles'),
  ('06',0.00,1.00,1.00,'rubbles'),
  ('11',0.00,1.50,0.00,'rubbles');

INSERT INTO public.tariff_option (option_id,incoming_buffer_cost,outcoming_buffer_cost,tariff_duration_minutes,free_between_providers,tariff_id,free_between_diff_providers) VALUES
 (1,0.00,0.00,300,false,'06',false),
 (2,0.50,0.00,100,false,'11',false);